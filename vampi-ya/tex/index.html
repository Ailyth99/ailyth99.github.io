<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PS2 ReTX</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="icon.png">
    <script src="wasm_exec.js"></script>
</head>
<body>

<div class="sidebar">
    <div class="sidebar-header">
        <a href="help.html" target="_blank" class="help-link" title="Open Manual">
            <img src="logo.png" alt="PS2 ReTX" class="app-logo">
        </a>
        <span class="version" data-i18n="version">v2.4 / Wasm Core</span>
    </div>

    <div class="scroll-content">
        <div class="control-group">
            <label data-i18n="sec_file">Source File</label>
            <div class="file-upload-wrapper">
                <input type="file" id="fileInput">
                <div class="file-upload-btn" id="fileBtnText" data-i18n="btn_load">üìÇ Load File</div>
            </div>
            <div class="status" id="fileStatus" data-i18n="no_file">No file loaded</div>
        </div>

        <div class="control-group">
            <label data-i18n="sec_dim_off">Dimensions & Offsets</label>
            <div class="row">
                <div class="input-wrap">
                    <span data-i18n="lbl_w">W</span>
                    <input type="number" id="width" value="256">
                </div>
                <div class="input-wrap">
                    <span data-i18n="lbl_h">H</span>
                    <input type="number" id="height" value="256">
                </div>
            </div>
            <div class="input-wrap mt-2">
                <span data-i18n="lbl_pixel">Pixel Offset</span>
                <input type="text" id="pixelOff" value="0" placeholder="0">
            </div>
            <div class="input-wrap mt-2">
                <span data-i18n="lbl_clut">CLUT Offset</span>
                <input type="text" id="clutOff" value="0" placeholder="0">
            </div>
        </div>

        <div class="control-group">
            <label data-i18n="sec_swizzle">Format & Swizzle</label>
            
            <div class="row-label">BPP (Bits Per Pixel)</div>
            <select id="bpp" class="mb-2">
                <option value="4">4bpp (16 colors)</option>
                <option value="8">8bpp (256 colors)</option>
                <option value="16">16bpp</option>
                <option value="32">32bpp</option>
            </select>

            <div class="row-label" data-i18n="lbl_swp">Pixel Swizzle</div>
            <select id="swp" class="mb-2">
                <option value="4packed" selected>4bpp Packed</option>
                <option value="4native">4bpp Native</option>
                <option value="4as8">4bpp as 8bpp</option>
                <option value="std">Standard</option>
                <option value="linear">Linear</option>
            </select>

            <div class="row-label" data-i18n="lbl_swc">CLUT Swizzle</div>
            <select id="swc">
                <option value="csm1">CSM1 (Standard)</option>
                <option value="linear">Linear</option>
            </select>
        </div>

        <div class="control-group">
            <label data-i18n="sec_color">CLUT Format & Alpha</label>
            <div class="row">
                <div class="input-wrap">
                    <select id="cf">
                        <option value="rgba8888">RGBA8888</option>
                        <option value="abgr1555">ABGR1555</option>
                    </select>
                </div>
                <div class="input-wrap">
                    <select id="alpha">
                        <option value="ps2">Alpha: PS2 (x2)</option>
                        <option value="ps2x2">Alpha: Low (x4)</option>
                        <option value="raw">Alpha: Raw</option>
                    </select>
                </div>
            </div>
            <div class="row mt-2">
                <label class="tool-checkbox" style="width:100%">
                    <input type="checkbox" id="doSwap"> <span data-i18n="lbl_swap">Nibble Swap</span>
                </label>
            </div>
        </div>

        <div class="control-group" style="border:none;">
            <label>Log</label>
            <textarea id="logArea" readonly></textarea>
        </div>
    </div>

    <div class="sidebar-footer">
        <!-- ‰ªÖ‰øùÁïô‰øùÂ≠òÊåâÈíÆ -->
        <button id="btnDownload" class="btn-primary" data-i18n="btn_save">üíæ Save PNG</button>
    </div>
</div>

<div class="main-area">
    <div class="toolbar">
        <div class="tool-group">
            <a href="help.html" target="_blank" class="btn-mini-toggle help-btn" title="Help">‚ùì Help</a>
            <div class="divider"></div>
            
            <button class="btn-mini-toggle" id="btnToggleBg" data-i18n="bg_dark">BG: Dark</button>
            <input type="color" id="bgColorPicker" value="#333333" title="Custom Background Color">
            
            <div class="divider"></div>
            
            <button class="btn-mini-toggle" id="btnFlipV" title="Flip Vertical" data-i18n="btn_flip_v">Flip Vert</button>
<button class="btn-mini-toggle" id="btnFlipH" title="Flip Horizontal" data-i18n="btn_flip_h">Flip Horz</button>
            
            <div class="tool-label" id="imgInfo" data-i18n="no_img" style="color: var(--color-success); margin-left: 10px;">No Image</div>
        </div>
        
        <div class="tool-group" style="flex:1; justify-content: flex-end;">
            <span class="tool-label"><span data-i18n="lbl_zoom">Zoom</span>: <span id="zoomValue">100%</span></span>
            <input type="range" id="zoomRange" min="0.1" max="5.0" step="0.1" value="1.0">
            <button class="btn-mini-toggle" id="btnFit" style="width: auto;" data-i18n="btn_fit">Fit</button>
        </div>
    </div>

    <div class="canvas-container dark-grid" id="canvasContainer" style="cursor: grab;">
        <img id="previewImage" src="" style="display: none;" draggable="false">
    </div>
</div>

<div id="loadingMask" class="loading-mask">
    <div class="loading-content">
        <img src="logo.png" alt="PS2 ReTX" class="loading-logo">
        <div class="loading-text">Initializing Core...</div>
        <div class="progress-container">
            <div id="progressBar" class="progress-bar"></div>
        </div>
        <div id="progressText" class="progress-info">0%</div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>